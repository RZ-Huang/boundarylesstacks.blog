---
import { getCategoryLinks, getTagLinks } from '@/modules/post';
import CategoryCard from '@/components/CategoryCard.astro';
import FilterList from '@/components/FilterList.astro';
import Tag from '@/components/Tag.astro';
import { cn } from '@/utils/styles';

import type { FilterLink } from '@/modules/post';
import type { PostCollection } from '@/types/post';

export interface Props extends astroHTML.JSX.AnchorHTMLAttributes {
  posts: PostCollection[];
}

const { posts, class: className, ...props } = Astro.props;

const tagLinks = getTagLinks(posts);
const categoryLinks = getCategoryLinks(posts);
---

<section {...props} class={cn(className)}>
  <h4>Categories:</h4>
  <FilterList class="mb-4 gap-4" itemLinks={categoryLinks}>
    {
      ({ href, text, textWithCount }: FilterLink) => (
        <CategoryCard href={href} category={text}>
          {textWithCount}
        </CategoryCard>
      )
    }
  </FilterList>

  <h4>Tags:</h4>
  <FilterList class="mb-4" itemLinks={tagLinks}>
    {
      ({ href, textWithCount, isActive }: FilterLink) => (
        <Tag href={href} size="md" class={cn({ 'underline font-bold text-accent': isActive })}>
          {textWithCount}
        </Tag>
      )
    }
  </FilterList>
</section>
